/*!
 * jodit-pro - PRO Version of Jodit Editor
 * Author: Chupurnov Valeriy <chupurnov@gmail.com>
 * Version: v4.1.14
 * Url: https://xdsoft.net/jodit/pro/
 * License(s): SEE LICENSE IN LICENSE.md
 */


"use strict";((e,t)=>{if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var i in r)("object"==typeof exports?exports:e)[i]=r[i]}})(self,(function(){return(self.webpackChunkjodit_pro=self.webpackChunkjodit_pro||[]).push([[726],{14833(e,t,r){r.r(t),r.d(t,{highlightSignature(){return c}});var i=r(31635),o=r(53557),s=r(23545),n=r(97099),a=r(67141),h=r(91288),l=r(25511);h.T.prototype.highlightSignature={schema:{},excludeTags:["pre"]};class c extends a.k{constructor(){super(...arguments),this.idleId=0}afterInit(e){Object.keys(e.o.highlightSignature.schema).length&&e.e.on("change afterSetMode",this.walkNodes).on("afterGetValueFromEditor",c.removeUtilWrappers)}beforeDestruct(e){e.e.off("change afterSetMode",this.walkNodes).off("afterGetValueFromEditor",c.removeUtilWrappers)}walkNodes(){if(!this.j.isEditorMode())return;this.checkUtilsBoxToSchema();const{j:e}=this,t=e.ed.createNodeIterator(e.editor,NodeFilter.SHOW_TEXT);this.j.async.cancelIdleCallback(this.idleId),this.workLoop(t)}runWorker(e,t){let r;this.j.e.mute();try{do{if(r=t.nextNode(),!r)return;if(this.checkNormalizing(r))return;this.checkReplaceSchemas(r)}while(r&&e.timeRemaining()>0)}finally{this.j.e.unmute()}this.workLoop(t)}workLoop(e){this.idleId=this.j.async.requestIdleCallback((t=>{this.runWorker(t,e)}),{timeout:this.j.defaultTimeout})}checkNormalizing(e){return!!s.J.isText(e.nextSibling)&&(this.j.editor.normalize(),this.walkNodes(),!0)}checkReplaceSchemas(e){if(c.hasUtilWrapper(e))return;const t=e.nodeValue;if(null==t)return;const{j:r}=this,i=r.o.highlightSignature;for(const r in i.schema){const o=RegExp(r);if(o.test(t)){const n=t.match(o);if(!n||void 0===n.index)continue;const a=i.schema[r](this.j,n);if(a)return s.J.markTemporary(a,{dataHighlightSchema:r}),void this.replaceMatchedTextToElm(e,t,n,a)}}}replaceMatchedTextToElm(e,t,r,i){const{j:o}=this,{range:n}=o.s,a=n.startContainer===e,h=n.startOffset,l=r.index??0;e.nodeValue=t.substring(0,l);const c=t.substring(l+r[0].length);if(c.length){const t=o.createInside.text(c);s.J.after(e,t)}i.innerText=r[0],s.J.after(e,i),a&&this.restoreCursorPosition(h,e,i.firstChild,i.nextSibling)}static hasUtilWrapper(e){return s.J.isTemporary(e.parentElement)}static removeUtilWrappers(e){e.value=s.J.replaceTemporaryFromString(e.value)}restoreCursorPosition(e,...t){for(const r of t)if(r&&r.nodeValue){const t=r.nodeValue;if(t.length>=e){const t=this.j.s.createRange();t.setStart(r,e),this.j.s.selectRange(t,!1);break}e-=t.length}}checkUtilsBoxToSchema(){s.J.temporaryList(this.j.editor).forEach((e=>{const t=(0,n.C)(e,"dataHighlightSchema");if(!t)return;const r=RegExp(t),i=e.innerText??"";r.test(i)&&!i.replace(r,"").length||(this.j.s.save(),s.J.unwrap(e),this.j.s.restore())}))}}c.requires=["license"],(0,i.Cg)([(0,o.debounce)()],c.prototype,"walkNodes",null),(0,i.Cg)([o.autobind],c.prototype,"runWorker",null),l.A.plugins.add("highlight-signature",c)}},e=>e(e.s=14833)])}));